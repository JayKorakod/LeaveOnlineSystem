@model LeaveSystemOnline.EMPLOYEE
@{
    ViewBag.Title = "เพิ่มข้อมูลผู้ใช้งาน";
}

<h2 align="center">เพิ่มข้อมูลพนักงาน</h2>


@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    <div>

        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        <div class="form-group">
            <h3>ข้อมูลส่วนตัว</h3>
            @Html.Label("ชื่อ")
            <div class="col-md-10">
                @Html.EditorFor(model => model.firstName, new { htmlAttributes = new { @class = "form-control", @maxlength = "30", @id = "fname" } })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("นามสกุล")
            <div class="col-md-10">
                @Html.EditorFor(model => model.lastName, new { htmlAttributes = new { @class = "form-control", @maxlength = "30", @id = "lname" } })
            </div>
        </div>
        <div class="form-group">
            @Html.Label("วันเกิด")
            <div class="col-md-10">
                @Html.EditorFor(model => model.birthdate, new { htmlAttributes = new { @class = "form-control", @id = "datepicker-component2", @placeholder = "mm/dd/yyyy", } })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("รหัสบัตรประชาชน")
            <div class="col-md-10">
                @Html.EditorFor(model => model.identificationNo, new { htmlAttributes = new { @class = "form-control", @maxlength = "13", @id = "iden" } })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("เบอร์โทรศัพท์")
            <div class="col-md-10">
                @Html.EditorFor(model => model.tel, new { htmlAttributes = new { @class = "form-control", @maxlength = "10", @id = "tel" } })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("แผนก")
            <div class="col-md-10">
                @{
                    List<SelectListItem> listDepartment = new List<SelectListItem>();
                    listDepartment.Add(new SelectListItem
                    {
                        Text = "วิศวกรรม",
                        Value = "วิศวกรรม"
                    });
                    listDepartment.Add(new SelectListItem
                    {
                        Text = "เทคโนโลยีสารสนเทศ",
                        Value = "เทคโนโลยีสารสนเทศ"
                    });
                    listDepartment.Add(new SelectListItem
                    {
                        Text = "จัดซื้อ",
                        Value = "จัดซื้อ"
                    });
                    listDepartment.Add(new SelectListItem
                    {
                        Text = "คลังสินค้า",
                        Value = "คลังสินค้า"
                    });
                    listDepartment.Add(new SelectListItem
                    {
                        Text = "บุคคล",
                        Value = "บุคคล"
                    });
                    listDepartment.Add(new SelectListItem
                    {
                        Text = "การตลาด",
                        Value = "การตลาด"
                    });
                    listDepartment.Add(new SelectListItem
                    {
                        Text = "รักษาความปลอดภัย",
                        Value = "รักษาความปลอดภัย"
                    });
                    listDepartment.Add(new SelectListItem
                    {
                        Text = "ฝ่ายผลิต",
                        Value = "ฝ่ายผลิต"
                    });
                }
                @Html.DropDownListFor(model => model.department, listDepartment, "-- เลือกแผนก --", new { @class = "form-control", @id = "department" })
            </div>
        </div>
        <br />

        <div class="form-group">
            <h3>ที่อยู่</h3>
            @Html.Label("บ้านเลขที่")
            <div class="col-md-10">
                @Html.EditorFor(model => model.homeNo, new { htmlAttributes = new { @class = "form-control", @maxlength = "7", @id = "homeno" } })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("ซอย")
            <div class="col-md-10">
                @Html.EditorFor(model => model.soi, new { htmlAttributes = new { @class = "form-control", @maxlength = "30", @id = "soi" } })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("ถนน")
            <div class="col-md-10">
                @Html.EditorFor(model => model.road, new { htmlAttributes = new { @class = "form-control", @maxlength = "30", @id = "road" } })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("จังหวัด")
            <div class="col-md-10">
                @if (ViewBag.ProvinceList != null)
                {
                    @Html.DropDownListFor(x => x.province, ViewBag.ProvinceList as SelectList, "-- Select Province --", new { @class = "form-control", id = "province" })
                }
            </div>
        </div>

        <div class="form-group">
            @Html.Label("อำเภอ")
            <div class="col-md-10">
                @Html.DropDownListFor(x => x.district, new SelectList(""), "-- Select District -- ", new { @class = "form-control", id = "district" })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("ตำบล")
            <div class="col-md-10">
                @Html.DropDownListFor(x => x.subdistrict, new SelectList(""), "-- Select SubDistrict -- ", new { @class = "form-control", id = "subdistrict" })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("รหัสไปรษณีย์")
            <div class="col-md-10">
                @Html.EditorFor(model => model.postalCode, new { htmlAttributes = new { @class = "form-control", @maxlength = "5", @id = "postal" } })
            </div>
        </div>

        <div class="form-group">
            <h3>อีเมล</h3>
            @Html.Label("อีเมล")
            <div class="col-md-10">
                @Html.EditorFor(model => model.email, new { htmlAttributes = new { @class = "form-control", @maxlength = "30", @id = "email" } })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("รหัสผ่าน")
            <div class="col-md-10">
                @Html.EditorFor(model => model.password, new { htmlAttributes = new { @class = "form-control", @maxlength = "6", @id = "password" } })
            </div>
        </div>


        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <button type="submit" value="บันทึก" class="btn btn-primary" id="save">บันทึก</button>
            </div>
        </div>
    </div>
}

<script src="~/Scripts/jquery-3.4.1.min.js"></script>
<script>
    $(document).ready(function () {
        $("#province").change(function () {
            var provinceId = $(this).val();
            $.ajax({
                type: "get",
                url: "/Employee/GetDistrictList?provinceID=" + provinceId,
                contentType: "html",
                success: function (response) {
                    $("#district").empty();
                    $("#district").append(response);
                }
            })
        })

        $("#district").change(function () {
            var districtID = $(this).val();
            $.ajax({
                type: "get",
                url: "/Employee/GetSubDistrictList?districtID=" + districtID,
                contentType: "html",
                success: function (response) {
                    $("#subdistrict").empty();
                    $("#subdistrict").append(response);
                }
            })
        })
    })
</script>
<script>
    // เรียกใช้ Class dropdownlist
    $(function () {
        $('#province').select2();
        $('#district').select2();
        $('#subdistrict').select2();
        $('#department').select2();
    })
</script>
<script>
    $("#save").click(function () {
        if ($('#fname').val() == '' || $('#lname').val() == '' || $('#datepicker-component2').val() == '' || $('#iden').val() == '' ||
            $('#tel').val() == '' || $('#department').val() == '' || $('#homeno').val() == '' || $('#soi').val() == '' || $('#road').val() == '' ||
            $('#province').val() == '' || $('#district').val() == '' || $('#subdistrict').val() == '' || $('#postal').val() == '' ||
            $('#email').val() == '' || $('#password').val() == '') {
            Alert_Warning();
        }
        else {
            Alert_Success();
        }
    });

    function Alert_Success() {
        Swal.fire({
            icon: 'success',
            title: 'บันทึกสำเร็จ',
            showConfirmButton: false,
            timer: 1500,
        })
    }

    function Alert_Warning() {
        Swal.fire({
            icon: 'error',
            title: 'ผิดพลาด',
            text: 'กรุณาตรวจสอบข้อมูลที่กรอก',
        })
    }
</script>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
